{
  "name" : "Salesforce",
  "tags": ["outgoing","oneColumn", "batch"],
  "description" : "Send Users as Leads or Contacts to Salesforce with custom mappings",
  "readme" : "readme.md",
  "admin" : "/auth",
  "version" : "0.2.0",
  "picture": "picture.png",
  "ui": false,
  "settings" : [
    {
      "name" : "last_sync_at",
      "type" : "number",
      "format" : "hidden"
    }
  ],
  "private_settings" : [
    {
      "name": "salesforce_login",
      "type": "string",
      "required" : true
    },
    {
      "name": "refresh_token",
      "type": "string",
      "required" : true
    },
    {
      "name": "access_token",
      "type": "string",
      "required" : true
    },
    {
      "name": "instance_url",
      "type": "string",
      "required" : true
    },    
    {
      "name": "salesforce_password",
      "type": "string",
      "required" : true
    },
    {
      "name": "salesforce_login_url",
      "type": "string",
      "required" : true,
      "default" : "https://login.salesforce.com"
    },
    {
      "name": "synchronized_segments",
      "title": "Filter users",
      "description": "Only send Users matching one or more of these segments. Sends everyone if empty.",
      "type": "array",
      "format": "segment",
      "items": {
        "type": "string"
      },
      "default": []
    },
    {
      "name": "leads",
      "title": "Leads sync",
      "format": "title",
      "type": "string"
    },
    {
      "name" : "leads_mapping",
      "title" : "List of Lead fields to push to Salesforce",
      "type" : "array",
      "format" : "table",
      "default" : [
        { "hull_field_name" : "first_name", "salesforce_field_name" : "FirstName", "default_value" : "[Unknown]", "overwrite" : false },
        { "hull_field_name" : "last_name", "salesforce_field_name" : "LastName", "default_value" : "[Unknown]", "overwrite" : false },
        { "hull_field_name" : "email", "salesforce_field_name" : "Email", "overwrite" : false }
      ],
      "items" : {
        "type" : "object",
        "properties" : {
          "hull_field_name" : {
            "type" : "string",
            "format" : "trait",
            "title" : "Hull Field"
          },
          "salesforce_field_name" : {
            "type" : "string",
            "title" : "Salesforce Field",
            "format" : "select",
            "options" : {
              "loadOptions" : "/schema/lead_updateable"
            }
          },
          "overwrite" : {
            "type" : "boolean",
            "title" : "overwrite",
            "default" : false
          }
        },
        "required" : [
          "hull_field_name",
          "salesforce_field_name"
        ]
      }
    },
    {
      "name" : "fetch_lead_fields",
      "title" : "List of Lead fields to fetch from Salesforce",
      "type" : "array",
      "format" : "select",
      "options" : {
        "loadOptions" : "/schema/lead"
      }
    },
    {
      "name": "contacts",
      "title": "Contacts sync",
      "format": "title",
      "type": "string"
    },
    {
      "name" : "contacts_mapping",
      "title" : "List of Contact fields to push to Salesforce",
      "type" : "array",
      "format" : "table",
      "default" : [
        { "hull_field_name" : "first_name", "salesforce_field_name" : "FirstName", "default_value" : "[Unknown]", "overwrite" : false },
        { "hull_field_name" : "last_name", "salesforce_field_name" : "LastName", "default_value" : "[Unknown]", "overwrite" : false },
        { "hull_field_name" : "email", "salesforce_field_name" : "Email", "overwrite" : false }
      ],
      "items" : {
        "type" : "object",
        "properties" : {
          "hull_field_name" : {
            "type" : "string",
            "format" : "trait",
            "title" : "Hull Field"
          },
          "salesforce_field_name" : {
            "type" : "string",
            "title" : "Salesforce Field",
            "format" : "select",
            "options" : {
              "loadOptions": "/schema/contact_updateable"
            }
          },
          "overwrite" : {
            "type" : "boolean",
            "title" : "Hull overwrites Salesforce",
            "default" : false
          }
        },
        "required" : [
          "hull_field_name",
          "salesforce_field_name"
        ]
      }
    },
    {
      "name" : "fetch_contact_fields",
      "title" : "List of Contact fields to fetch from Salesforce",
      "type" : "array",
      "format" : "select",
      "options" : {
        "loadOptions" : "/schema/contact"
      }
    }
  ],
  "schedules": [
    {
      "url": "/sync",
      "type": "cron",
      "value": "*/5 * * * *"
    }
  ],
  "subscriptions" : [ { "url" : "/notify" } ]
}
